<app-navigation-buttons [backRoute]="'/admin'"></app-navigation-buttons>

<div class="nota-wrapper">
  <!-- Card principal -->
  <div class="card">
    <h2>5. Nota de Incumplimiento</h2>

    <div *ngIf="errorMensaje" class="error-banner" style="margin-bottom: 12px;">
      {{ errorMensaje }}
    </div>

    <p><strong>¿Qué es?</strong></p>
    <p>
      Es una amonestación escrita digitalmente, que se emite cuando el colaborador no corrige el problema,
      a pesar de las acciones anteriores.
    </p>

    <p><strong>¿Cómo hacerlo?</strong></p>
    <ul>
      <li>Mandar un correo que describa el comportamiento reincidente.</li>
      <li>Indicar que ya hubo capacitación, seguimiento y retroalimentación.</li>
    </ul>

    <!-- Formulario reactivo -->
    <form [formGroup]="notaForm" (ngSubmit)="onSubmit()">

      <div class="form-group">
        <label>Nombre del colaborador*</label>
        <input
          type="text"
          placeholder="Ejemplo: Juan Pérez"
          formControlName="comportamiento"
        />
      </div>

      <div class="form-group">
        <label>Descripción del incumplimiento*</label>
        <textarea
          rows="3"
          placeholder="Escribe el detalle..."
          formControlName="observaciones"
        ></textarea>
      </div>

      <!-- Fila de botones, igual que en Evaluar Resultados -->
      <div class="acciones">
        <!-- Izquierda: Guardar -->
        <button type="submit" class="btn-guardar" [disabled]="isLoading">
          {{ modoEdicion ? 'Actualizar' : 'Guardar' }}
        </button>

        <!-- Derecha: Continuar / Terminar -->
        <div class="acciones-derecha">
          <button type="button" class="btn-continuar" (click)="continuarProceso()" [disabled]="isLoading">
            Continuar al paso 6
          </button>

          <button type="button" class="btn-terminar" (click)="terminarProceso()" [disabled]="isLoading">
            Terminar Proceso
          </button>
        </div>
      </div>
    </form>
  </div>

  <!-- Card de cierre, mismo ancho y centrado -->
  <div class="card" *ngIf="mostrarTerminarProceso">
    <h3>Justificación de Cierre</h3>

    <form [formGroup]="cierreForm" (ngSubmit)="enviarCierre()">
      <div class="form-group">
        <label>Motivo de finalización*</label>
        <textarea rows="3" formControlName="justificacion" placeholder="Explique por qué se cierra el proceso..."></textarea>
      </div>

      <button type="submit" class="btn-guardar" [disabled]="isLoading">Enviar Justificación</button>
    </form>
  </div>
</div>
