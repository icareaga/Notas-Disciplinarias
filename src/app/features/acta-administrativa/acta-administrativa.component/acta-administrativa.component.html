<app-navigation-buttons [backRoute]="'/admin'"></app-navigation-buttons>

<div class="form-container">
  <h2>6. Acta Administrativa</h2>

  <div *ngIf="errorMensaje" class="alert-error">{{ errorMensaje }}</div>

  <form [formGroup]="actaForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="colaborador">Colaborador</label>
      <input id="colaborador" type="text" formControlName="colaborador" placeholder="Nombre del colaborador" />
      <small *ngIf="actaForm.get('colaborador')?.touched && actaForm.get('colaborador')?.invalid">Campo requerido</small>
    </div>

    <div class="form-group">
      <label for="historial">Historial</label>
      <textarea id="historial" formControlName="historial" placeholder="Describe el historial"></textarea>
      <small *ngIf="actaForm.get('historial')?.touched && actaForm.get('historial')?.invalid">Campo requerido</small>
    </div>

    <div class="form-group">
      <label for="evidencias">Evidencias</label>
      <textarea id="evidencias" formControlName="evidencias" placeholder="Describe las evidencias"></textarea>
    </div>

    <div class="form-group">
      <label for="versionColaborador">Versión del colaborador</label>
      <textarea id="versionColaborador" formControlName="version_colaborador" placeholder="Versión del colaborador"></textarea>
    </div>

    <div class="form-group">
      <label for="firmas">Firmas</label>
      <input id="firmas" type="text" formControlName="firmas" placeholder="Firmas" />
    </div>

    <div class="button-group">
      <button type="submit" [disabled]="isLoading">{{ modoEdicion ? 'Actualizar' : 'Guardar' }}</button>
      <button type="button" class="cancel" (click)="finalizarProceso()" [disabled]="isLoading">Completar (cierra el caso)</button>
    </div>
  </form>

  <div class="cierre-section">
    <button type="button" class="btn-cierre" (click)="terminarProceso()" [disabled]="isLoading">
      Terminar Proceso (cierre manual)
    </button>

    <div *ngIf="mostrarTerminarProceso" class="cierre-form" [formGroup]="cierreForm">
      <label for="justificacionCierre">Justificación de cierre</label>
      <textarea id="justificacionCierre" formControlName="justificacion" placeholder="Describe el motivo del cierre"></textarea>
      <small *ngIf="cierreForm.get('justificacion')?.touched && cierreForm.get('justificacion')?.invalid">Campo requerido</small>

      <div class="cierre-actions">
        <button type="button" class="btn-cerrar" (click)="enviarCierre()" [disabled]="isLoading">Cerrar caso</button>
        <button type="button" class="btn-cancelar" (click)="mostrarTerminarProceso=false" [disabled]="isLoading">Cancelar</button>
      </div>
    </div>
  </div>
</div>
