<div class="usuario-container">
  <app-navigation-buttons></app-navigation-buttons>
  
  <h2 class="titulo">
    <span class="emoji">
      <svg width="28" height="28" fill="#0a47a1" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title>eye</title> <path d="M0 16q0.064 0.128 0.16 0.352t0.48 0.928 0.832 1.344 1.248 1.536 1.664 1.696 2.144 1.568 2.624 1.344 3.136 0.896 3.712 0.352 3.712-0.352 3.168-0.928 2.592-1.312 2.144-1.6 1.664-1.632 1.248-1.6 0.832-1.312 0.48-0.928l0.16-0.352q-0.032-0.128-0.16-0.352t-0.48-0.896-0.832-1.344-1.248-1.568-1.664-1.664-2.144-1.568-2.624-1.344-3.136-0.896-3.712-0.352-3.712 0.352-3.168 0.896-2.592 1.344-2.144 1.568-1.664 1.664-1.248 1.568-0.832 1.344-0.48 0.928zM10.016 16q0-2.464 1.728-4.224t4.256-1.76 4.256 1.76 1.76 4.224-1.76 4.256-4.256 1.76-4.256-1.76-1.728-4.256zM12 16q0 1.664 1.184 2.848t2.816 1.152 2.816-1.152 1.184-2.848-1.184-2.816-2.816-1.184-2.816 1.184l2.816 2.816h-4z"></path> </g></svg>
    </span>
    Mis Casos Disciplinarios
  </h2>

  <table class="tabla">
    <thead>
      <tr>
        <th class="col-id">ID</th>
        <th class="col-motivo">Motivo</th>
        <th class="col-paso">Paso actual</th>
        <th class="col-estatus">Estatus</th>
        <th class="col-fecha">Fecha de creaci贸n</th>
        <th class="col-acciones">Acciones</th>
      </tr>
    </thead>
    <tbody>
      @for (c of casos; track c.id) {
        <tr>
          <td class="col-id id-caso"><strong>#{{ c.id }}</strong></td>
          <td class="col-motivo">{{ c.motivo }}</td>
          <td class="col-paso">
            <span class="badge" [ngClass]="'badge-' + c.estado.toLowerCase()">
              Paso {{ c.pasoActual }} 路 {{ c.pasoActualTexto }}
            </span>
          </td>
          <td class="col-estatus">
            <span class="badge-estatus" [ngClass]="c.estatusCaso === 1 ? 'activo' : 'cerrado'">
              <svg width="12" height="12" [attr.fill]="c.estatusCaso === 1 ? '#0f5132' : '#842029'" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg>
              {{ c.estatusCaso === 1 ? 'Activo' : 'Cerrado' }}
            </span>
          </td>
          <td class="col-fecha">{{ c.fecha | date:'yyyy-MM-dd' }}</td>
          <td class="col-acciones">
            <button class="btn-ver" (click)="verCaso(c)" title="Ver detalle">
              <svg width="16" height="16" fill="currentColor" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title>eye</title> <path d="M0 16q0.064 0.128 0.16 0.352t0.48 0.928 0.832 1.344 1.248 1.536 1.664 1.696 2.144 1.568 2.624 1.344 3.136 0.896 3.712 0.352 3.712-0.352 3.168-0.928 2.592-1.312 2.144-1.6 1.664-1.632 1.248-1.6 0.832-1.312 0.48-0.928l0.16-0.352q-0.032-0.128-0.16-0.352t-0.48-0.896-0.832-1.344-1.248-1.568-1.664-1.664-2.144-1.568-2.624-1.344-3.136-0.896-3.712-0.352-3.712 0.352-3.168 0.896-2.592 1.344-2.144 1.568-1.664 1.664-1.248 1.568-0.832 1.344-0.48 0.928zM10.016 16q0-2.464 1.728-4.224t4.256-1.76 4.256 1.76 1.76 4.224-1.76 4.256-4.256 1.76-4.256-1.76-1.728-4.256zM12 16q0 1.664 1.184 2.848t2.816 1.152 2.816-1.152 1.184-2.848-1.184-2.816-2.816-1.184-2.816 1.184l2.816 2.816h-4z"></path> </g></svg>
              Ver
            </button>
          </td>
        </tr>
      }

      @if (casos.length === 0) {
        <tr>
          <td colspan="6" style="text-align:center; color:#666; padding: 20px;">
            No tienes casos disciplinarios registrados.
          </td>
        </tr>
      }
    </tbody>
  </table>
</div>

<!-- Modal para ver detalles -->
@if (mostrarModal && casoSeleccionado) {
  <div class="modal-overlay" (click)="cerrarModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Detalles del Caso #{{ casoSeleccionado.id }}</h2>
        <button class="btn-close" (click)="cerrarModal()">&times;</button>
      </div>
      
      <div class="modal-body">
        <div class="detalle-grid">
          <div class="detalle-item">
            <label><svg width="14" height="14" fill="currentColor" viewBox="0 0 24 24" style="vertical-align:middle; margin-right:4px;"><path d="M21.41 11.58l-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.55-.23-1.06-.59-1.42zM5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7z"/></svg>Motivo:</label>
            <p>{{ casoSeleccionado.motivo }}</p>
          </div>

          <div class="detalle-item">
            <label><svg width="14" height="14" fill="currentColor" viewBox="0 0 24 24" style="vertical-align:middle; margin-right:4px;"><path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zm0-12H5V6h14v2z"/></svg>Fecha:</label>
            <p>{{ casoSeleccionado.fecha | date:'dd/MM/yyyy' }}</p>
          </div>

          <div class="detalle-item">
            <label><svg width="14" height="14" fill="currentColor" viewBox="0 0 24 24" style="vertical-align:middle; margin-right:4px;"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>Paso Actual:</label>
            <p>
              <span class="badge" [ngClass]="'badge-' + casoSeleccionado.estado.toLowerCase()">
                Paso {{ casoSeleccionado.pasoActual }} 路 {{ casoSeleccionado.pasoActualTexto }}
              </span>
            </p>
          </div>

          <div class="detalle-item">
            <label><svg width="14" height="14" fill="currentColor" viewBox="0 0 24 24" style="vertical-align:middle; margin-right:4px;"><path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/></svg>Estatus:</label>
            <p>
              <span class="badge-estatus" [ngClass]="casoSeleccionado.estatusCaso === 1 ? 'activo' : 'cerrado'">
                <svg width="10" height="10" [attr.fill]="casoSeleccionado.estatusCaso === 1 ? '#0f5132' : '#842029'" viewBox="0 0 24 24" style="vertical-align:middle; margin-right:4px;"><circle cx="12" cy="12" r="10"/></svg>
                {{ casoSeleccionado.estatusCaso === 1 ? 'Activo' : 'Cerrado' }}
              </span>
            </p>
          </div>
        </div>

        @if (casoSeleccionado.descripcion) {
          <div class="detalle-item full-width">
            <label><svg width="14" height="14" fill="currentColor" viewBox="0 0 24 24" style="vertical-align:middle; margin-right:4px;"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>Descripci贸n:</label>
            <p class="texto-largo">{{ casoSeleccionado.descripcion }}</p>
          </div>
        }

        @if (casoSeleccionado.impacto) {
          <div class="detalle-item full-width">
            <label><svg width="14" height="14" fill="currentColor" viewBox="0 0 24 24" style="vertical-align:middle; margin-right:4px;"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>Impacto:</label>
            <p class="texto-largo">{{ casoSeleccionado.impacto }}</p>
          </div>
        }

        @if (casoSeleccionado.conducta) {
          <div class="detalle-item full-width">
            <label><svg width="14" height="14" fill="currentColor" viewBox="0 0 24 24" style="vertical-align:middle; margin-right:4px;"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>Conducta:</label>
            <p class="texto-largo">{{ casoSeleccionado.conducta }}</p>
          </div>
        }
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="cerrarModal()">Cerrar</button>
      </div>
    </div>
  </div>
}
